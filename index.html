<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>特殊表盘 - 时辰·小时·月份·节气</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(to bottom right, #1F2937, #111827);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      font-family: 'Noto Serif SC', serif;
      transition: background 0.3s ease;
      transform: translateY(-24px);
    }
    
    body.day-mode {
      background: linear-gradient(to bottom right, #f3f4f6, #e5e7eb);
      color: #111827;
      transform: translateY(-24px);
    }
    
    /* 模式切换按钮样式 */
    #mode-toggle {
      cursor: pointer;
      border: none;
      outline: none;
    }
    
    body.day-mode #mode-toggle {
      background: #3b82f6;
      color: white;
    }
    
    body.day-mode #mode-toggle:hover {
      background: #2563eb;
    }
    
    .watch-container {
      position: relative;
      width: 100%;
      max-width: 500px;
      aspect-ratio: 1/1;
      margin: 0 auto;
    }
    
    #watchFace {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      background: #1F2937;
      border: 4px solid #374151;
      transition: all 0.3s ease;
    }
    
    body.day-mode #watchFace {
      background: white;
      border: 4px solid #111827;
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
    }
    
    .info-panel {
      position: absolute;
      bottom: -150px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 380px;
      padding: 1rem;
      border-radius: 1rem;
      background: rgba(31, 41, 55, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid #374151;
      transition: all 0.3s ease;
    }
    
    body.day-mode .info-panel {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid #d1d5db;
    }
    
    .watch-text {
      fill: #94a3b8;
      font-size: 14px;
      text-anchor: middle;
      dominant-baseline: middle;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .watch-text.active {
      fill: #F3F4F6;
      font-weight: bold;
      font-size: 16px;
    }
    
    body.day-mode .watch-text {
      fill: #6b7280;
    }
    
    body.day-mode .watch-text.active {
      fill: #111827;
    }
    
    .pointer {
      transform-origin: 250px 250px;
      transition: transform 0.1s linear;
    }
    
    .hour-hand {
      stroke: #6366f1;
      stroke-width: 4;
      stroke-linecap: round;
    }
    
    .minute-hand {
      stroke: #10b981;
      stroke-width: 3;
      stroke-linecap: round;
    }
    
    .second-hand {
      stroke: #ef4444;
      stroke-width: 2;
      stroke-linecap: round;
    }
    
    body.day-mode .hour-hand {
      stroke: #111827;
    }
    
    body.day-mode .minute-hand {
      stroke: #111827;
    }
    
    body.day-mode .second-hand {
      stroke: #ef4444;
    }
    
    body.day-mode .center-dot {
      fill: black;
    }
  </style>
</head>
<body>

  
  <div class="watch-container">
    <svg id="watchFace" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
      <circle id="clock-bg" cx="250" cy="250" r="245" fill="#1F2937"></circle>
      
      <circle cx="250" cy="250" r="100" fill="none" stroke="#374151" stroke-width="1"></circle>
      <circle cx="250" cy="250" r="150" fill="none" stroke="#374151" stroke-width="1"></circle>
      <circle cx="250" cy="250" r="200" fill="none" stroke="#374151" stroke-width="1"></circle>
      
      <g id="time-texts"></g>
      <g id="hour-texts"></g>
      <g id="month-texts"></g>
      <g id="season-texts"></g>
      
      <g id="pointers">
        <line id="hour-hand" class="pointer hour-hand" x1="250" y1="250" x2="250" y2="160"></line>
        <line id="minute-hand" class="pointer minute-hand" x1="250" y1="250" x2="250" y2="130"></line>
        <line id="second-hand" class="pointer second-hand" x1="250" y1="250" x2="250" y2="110"></line>
      </g>
      
      <circle cx="250" cy="250" r="6" fill="white" class="center-dot"></circle>
    </svg>
    
    <!-- 模式切换按钮 -->
    <button id="mode-toggle" class="absolute left-1/2 transform -translate-x-12 -bottom-14 w-10 h-10 bg-gray-700 text-white rounded-full hover:bg-gray-600 transition-colors flex items-center justify-center z-10">
      <!-- 太阳图标 -->
      <svg id="sun-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
      </svg>
      <!-- 月亮图标 -->
      <svg id="moon-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
      </svg>
    </button>
    
    <!-- 圆环隐藏/显示按钮 -->
    <button id="ring-toggle" class="absolute left-1/2 transform translate-x-2 -bottom-14 w-10 h-10 bg-gray-700 text-white rounded-full hover:bg-gray-600 transition-colors flex items-center justify-center z-10">
      <!-- 3个同心圆图标 -->
      <svg id="ring-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="2" stroke="currentColor" stroke-width="2"></circle>
        <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"></circle>
        <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="2"></circle>
      </svg>
    </button>
    
    <div class="info-panel">
      <div class="grid grid-cols-4 gap-2">
        <div class="text-center">
          <p class="text-xs text-gray-400">当前时间</p>
          <p id="currentHour" class="text-lg font-bold text-indigo-500"></p>
        </div>
        <div class="text-center">
          <p class="text-xs text-gray-400">当前时辰</p>
          <p id="currentTime" class="text-lg font-bold text-red-500"></p>
        </div>
        <div class="text-center">
          <p class="text-xs text-gray-400">当前月份</p>
          <p id="currentMonth" class="text-lg font-bold text-pink-500"></p>
        </div>
        <div class="text-center">
          <p class="text-xs text-gray-400">当前节气</p>
          <p id="currentSeason" class="text-lg font-bold text-yellow-500"></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    const timeData = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
    const hourData = [24, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23];
    const monthData = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
    const seasonData = [
      '立春', '雨水', '惊蛰', '春分', '清明', '谷雨',
      '立夏', '小满', '芒种', '夏至', '小暑', '大暑',
      '立秋', '处暑', '白露', '秋分', '寒露', '霜降',
      '立冬', '小雪', '大雪', '冬至', '小寒', '大寒'
    ];
    
    let previousTimeIndex = -1;
    let previousHourIndex = -1;
    let previousMonthIndex = -1;
    let previousSeasonIndex = -1;
    
    function drawTexts() {
      drawRingTexts('time-texts', timeData, 12, 80, 18);
      drawRingTexts('hour-texts', hourData, 24, 130, 14);
      drawRingTexts('month-texts', monthData, 12, 180, 16);
      drawSolarTerms();
    }
    
    function drawSolarTerms() {
      const container = document.getElementById('season-texts');
      container.innerHTML = '';
      
      const count = 24;
      const radius = 225;
      const fontSize = 12;
      const monthAngleStep = (Math.PI * 2) / 12; // 每个月份30度
      const termAngleOffset = monthAngleStep / 4; // 每个节气距离月份中心的偏移量7.5度
      
      // 调整起始角度，使节气与月份对应
      // 月份从12点位置开始(索引0 = 1月)
      // 每个月份的正确节气顺序
      const adjustedSeasonData = [
        '小寒', '大寒', // 1月
        '立春', '雨水', // 2月
        '惊蛰', '春分', // 3月
        '清明', '谷雨', // 4月
        '立夏', '小满', // 5月
        '芒种', '夏至', // 6月
        '小暑', '大暑', // 7月
        '立秋', '处暑', // 8月
        '白露', '秋分', // 9月
        '寒露', '霜降', // 10月
        '立冬', '小雪', // 11月
        '大雪', '冬至'  // 12月
      ];
      
      adjustedSeasonData.forEach((text, index) => {
        // 计算节气所属的月份
        const monthIndex = Math.floor(index / 2);
        // 计算月份的中心角度
        // 1月从12点位置开始(0度)，顺时针排列
        // 与月份的角度计算方向保持一致
        const monthAngle = (Math.PI / 2) + (monthIndex * monthAngleStep);
        // 计算节气的角度：月份中心角度 ± 7.5度
        // 每个月份的第一个节气在左侧(负偏移)，第二个节气在右侧(正偏移)
        const offset = index % 2 === 0 ? -termAngleOffset : termAngleOffset;
        const angle = monthAngle + offset;
        
        const x = 250 + Math.cos(angle) * radius;
        const y = 250 + Math.sin(angle) * radius;
        
        const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        textElement.setAttribute('x', x);
        textElement.setAttribute('y', y);
        textElement.setAttribute('text-anchor', 'middle');
        textElement.setAttribute('dominant-baseline', 'middle');
        textElement.setAttribute('font-size', fontSize);
        textElement.setAttribute('fill', '#94a3b8');
        textElement.setAttribute('class', 'watch-text');
        textElement.setAttribute('data-index', index);
        textElement.textContent = text;
        
        container.appendChild(textElement);
      });
    }
    
    function drawRingTexts(containerId, data, count, radius, fontSize) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      
      const angleStep = (Math.PI * 2) / count;
      
      data.forEach((text, index) => {
        const angle = (Math.PI / 2) + (index * angleStep);
        
        const x = 250 + Math.cos(angle) * radius;
        const y = 250 + Math.sin(angle) * radius;
        
        const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        textElement.setAttribute('x', x);
        textElement.setAttribute('y', y);
        textElement.setAttribute('text-anchor', 'middle');
        textElement.setAttribute('dominant-baseline', 'middle');
        textElement.setAttribute('font-size', fontSize);
        textElement.setAttribute('fill', '#94a3b8');
        textElement.setAttribute('class', 'watch-text');
        textElement.setAttribute('data-index', index);
        textElement.textContent = text;
        
        container.appendChild(textElement);
      });
    }
    
    function updateActiveTexts(timeIndex, hourIndex, monthIndex, seasonIndex) {
      const containers = ['time-texts', 'hour-texts', 'month-texts', 'season-texts'];
      const indices = [timeIndex, hourIndex, monthIndex, seasonIndex];
      
      containers.forEach((containerId, i) => {
        const container = document.getElementById(containerId);
        const texts = container.querySelectorAll('.watch-text');
        
        texts.forEach(text => {
          const index = parseInt(text.getAttribute('data-index'));
          
          if (index === indices[i]) {
            text.classList.add('active');
          } else {
            text.classList.remove('active');
          }
        });
      });
      
      previousTimeIndex = timeIndex;
      previousHourIndex = hourIndex;
      previousMonthIndex = monthIndex;
      previousSeasonIndex = seasonIndex;
    }
    
    function updateClockHands(hour, minute, second) {
      const hourAngle = (hour - 12) * 15 + minute * 0.25;
      const minuteAngle = minute * 6 + second * 0.1;
      const secondAngle = second * 6;
      
      document.getElementById('hour-hand').style.transform = `rotate(${hourAngle}deg)`;
      document.getElementById('minute-hand').style.transform = `rotate(${minuteAngle}deg)`;
      document.getElementById('second-hand').style.transform = `rotate(${secondAngle}deg)`;
    }
    
    // 2025年节气日期表 (月, 日) - 基于天文数据，顺序与seasonData一致
    const solarTerms2025 = [
      [2, 4],  // 立春
      [2, 19], // 雨水
      [3, 5],  // 惊蛰
      [3, 20], // 春分
      [4, 5],  // 清明
      [4, 20], // 谷雨
      [5, 5],  // 立夏
      [5, 21], // 小满
      [6, 5],  // 芒种
      [6, 21], // 夏至
      [7, 6],  // 小暑
      [7, 22], // 大暑
      [8, 7],  // 立秋
      [8, 22], // 处暑
      [9, 7],  // 白露
      [9, 23], // 秋分
      [10, 8], // 寒露
      [10, 23],// 霜降
      [11, 7], // 立冬
      [11, 22],// 小雪
      [12, 7], // 大雪
      [12, 22],// 冬至
      [1, 5],  // 小寒
      [1, 20]  // 大寒
    ];
    
    function getCurrentSolarTerm(now) {
      const year = now.getFullYear();
      const month = now.getMonth() + 1;
      const day = now.getDate();
      
      // 对于2025年，使用预定义的节气日期表
      const terms = solarTerms2025;
      
      // 根据月份找到对应的节气索引
      // 新的节气顺序是：小寒(0)、大寒(1)、立春(2)、雨水(3)、惊蛰(4)、春分(5)、清明(6)、谷雨(7)
      // 立夏(8)、小满(9)、芒种(10)、夏至(11)、小暑(12)、大暑(13)、立秋(14)、处暑(15)
      // 白露(16)、秋分(17)、寒露(18)、霜降(19)、立冬(20)、小雪(21)、大雪(22)、冬至(23)
      
      // 处理12月的情况
      if (month === 12) {
        if (day < terms[20][1]) { // 大雪之前
          return 21; // 小雪
        } else if (day < terms[21][1]) { // 冬至之前
          return 22; // 大雪
        } else { // 冬至及之后
          return 23; // 冬至
        }
      }
      
      // 处理1月的情况
      if (month === 1) {
        if (day < terms[22][1]) { // 小寒之前
          return 23; // 冬至
        } else if (day < terms[23][1]) { // 大寒之前
          return 0; // 小寒
        } else { // 大寒及之后
          return 1; // 大寒
        }
      }
      
      // 处理2月到11月的情况
      for (let i = 0; i < terms.length; i++) {
        const [termMonth, termDay] = terms[i];
        // 找到当前节气的下一个节气
        const nextIndex = (i + 1) % 24;
        const [nextMonth, nextDay] = terms[nextIndex];
        
        // 检查当前日期是否在当前节气和下一个节气之间
        if ((month === termMonth && day >= termDay && 
             (nextMonth !== termMonth || day < nextDay)) ||
            (month === termMonth && day >= termDay && nextMonth < termMonth)) {
          // 将原来的索引转换为新的顺序
          // 原来的索引：0=立春,1=雨水,2=惊蛰,3=春分,4=清明,5=谷雨,6=立夏,7=小满,8=芒种,9=夏至,10=小暑,11=大暑
          // 12=立秋,13=处暑,14=白露,15=秋分,16=寒露,17=霜降,18=立冬,19=小雪,20=大雪,21=冬至,22=小寒,23=大寒
          // 新的索引：0=小寒,1=大寒,2=立春,3=雨水,4=惊蛰,5=春分,6=清明,7=谷雨,8=立夏,9=小满,10=芒种,11=夏至
          // 12=小暑,13=大暑,14=立秋,15=处暑,16=白露,17=秋分,18=寒露,19=霜降,20=立冬,21=小雪,22=大雪,23=冬至
          if (i >= 0 && i <= 21) {
            return i + 2;
          } else if (i === 22) {
            return 0;
          } else if (i === 23) {
            return 1;
          }
        }
      }
      
      // 默认返回小寒
      return 0;
    }
    

    
    function updateInfoPanel() {
      const now = new Date();
      const hour = now.getHours();
      const minute = now.getMinutes();
      const second = now.getSeconds();
      const month = now.getMonth();
      
      const timeIndex = Math.floor((hour + 1) / 2) % 12;
      const hourIndex = hour === 0 ? 12 : hour;
      const monthIndex = month;
      const seasonIndex = getCurrentSolarTerm(now);
      
      updateActiveTexts(timeIndex, hourIndex, monthIndex, seasonIndex);
      updateClockHands(hour, minute, second);
      
      document.getElementById('currentTime').textContent = timeData[timeIndex];
      document.getElementById('currentHour').textContent = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}:${second.toString().padStart(2, '0')}`;
      document.getElementById('currentMonth').textContent = monthData[month];
      
      // 使用调整后的节气顺序来显示当前节气
      const adjustedSeasonData = [
        '小寒', '大寒', '立春', '雨水', '惊蛰', '春分', '清明', '谷雨',
        '立夏', '小满', '芒种', '夏至', '小暑', '大暑', '立秋', '处暑',
        '白露', '秋分', '寒露', '霜降', '立冬', '小雪', '大雪', '冬至'
      ];
      document.getElementById('currentSeason').textContent = adjustedSeasonData[seasonIndex];
    }
    
    document.addEventListener('DOMContentLoaded', function() {
      drawTexts();
      updateInfoPanel();
      
      setInterval(updateInfoPanel, 1000);
      
      // 模式切换逻辑
      const modeToggle = document.getElementById('mode-toggle');
      const body = document.body;
      const clockBg = document.getElementById('clock-bg');
      
      modeToggle.addEventListener('click', function() {
        body.classList.toggle('day-mode');
        
        // 获取图标元素
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        
        // 更新按钮样式和图标
        if (body.classList.contains('day-mode')) {
          modeToggle.classList.remove('bg-gray-700', 'hover:bg-gray-600');
          modeToggle.classList.add('bg-blue-500', 'hover:bg-blue-600');
          // 显示月亮图标，隐藏太阳图标
          sunIcon.classList.add('hidden');
          moonIcon.classList.remove('hidden');
          // 更新时钟背景
          clockBg.setAttribute('fill', 'white');
        } else {
          modeToggle.classList.remove('bg-blue-500', 'hover:bg-blue-600');
          modeToggle.classList.add('bg-gray-700', 'hover:bg-gray-600');
          // 显示太阳图标，隐藏月亮图标
          sunIcon.classList.remove('hidden');
          moonIcon.classList.add('hidden');
          // 更新时钟背景
          clockBg.setAttribute('fill', '#1F2937');
        }
        
        // 更新表盘圆圈的颜色
        const circles = document.querySelectorAll('#watchFace circle:not(#clock-bg):not([r="6"])');
        circles.forEach(circle => {
          if (body.classList.contains('day-mode')) {
            circle.setAttribute('stroke', '#d1d5db');
          } else {
            circle.setAttribute('stroke', '#374151');
          }
        });
        
        // 更新圆环按钮样式以匹配当前模式
        if (body.classList.contains('day-mode')) {
          ringToggle.classList.remove('bg-gray-700', 'hover:bg-gray-600', 'bg-purple-500', 'hover:bg-purple-600');
          if (ringsHidden) {
            ringToggle.classList.add('bg-purple-400', 'hover:bg-purple-500');
          } else {
            ringToggle.classList.add('bg-gray-300', 'hover:bg-gray-400');
          }
        } else {
          ringToggle.classList.remove('bg-gray-300', 'hover:bg-gray-400', 'bg-purple-400', 'hover:bg-purple-500');
          if (ringsHidden) {
            ringToggle.classList.add('bg-purple-500', 'hover:bg-purple-600');
          } else {
            ringToggle.classList.add('bg-gray-700', 'hover:bg-gray-600');
          }
        }
      });
      
      // 圆环隐藏/显示逻辑
      const ringToggle = document.getElementById('ring-toggle');
      let ringsHidden = false;
      
      ringToggle.addEventListener('click', function() {
        ringsHidden = !ringsHidden;
        
        // 获取所有圆环（不包括背景圆和中心圆点）
        const innerRings = document.querySelectorAll('#watchFace circle:not(#clock-bg):not([r="6"])');
        
        innerRings.forEach(ring => {
          if (ringsHidden) {
            ring.style.display = 'none';
          } else {
            ring.style.display = 'block';
          }
        });
        
        // 切换按钮样式
        if (ringsHidden) {
          ringToggle.classList.remove('bg-gray-700', 'hover:bg-gray-600');
          ringToggle.classList.add('bg-purple-500', 'hover:bg-purple-600');
        } else {
          ringToggle.classList.remove('bg-purple-500', 'hover:bg-purple-600');
          ringToggle.classList.add('bg-gray-700', 'hover:bg-gray-600');
        }
        
        // 日模式下的按钮样式
        if (body.classList.contains('day-mode')) {
          if (ringsHidden) {
            ringToggle.classList.remove('bg-gray-700', 'hover:bg-gray-600');
            ringToggle.classList.add('bg-purple-400', 'hover:bg-purple-500');
          } else {
            ringToggle.classList.remove('bg-purple-400', 'hover:bg-purple-500');
            ringToggle.classList.add('bg-gray-300', 'hover:bg-gray-400');
          }
        }
      });
      
      // 设置圆环按钮的初始样式，匹配当前模式
      if (body.classList.contains('day-mode')) {
        ringToggle.classList.add('bg-gray-300', 'hover:bg-gray-400');
      } else {
        ringToggle.classList.add('bg-gray-700', 'hover:bg-gray-600');
      }
    });
  </script>
</body>
</html>